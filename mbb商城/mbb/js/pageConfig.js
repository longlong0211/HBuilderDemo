window.pageConfig=(function(j,e){var g="";var c=null;var i=function(m){g=m;var l=j.localStorage.getItem("pages"),n=l==null?[]:JSON.parse(l);if(l==null||typeof n[g]=="undefined"){f(function(o){if(o){d(o)}else{a();return}})}else{plus.io.resolveLocalFileSystemURL("_doc/"+g+".json",function(o){d(o)},function(o){console.log("loadData"+o.message);a()})}};var d=function(l){l.file(function(n){var m=new plus.io.FileReader();m.onloadend=function(q){var o=j.localStorage.getItem("pages"),p=o==null?{}:JSON.parse(o);try{c=JSON.parse(q.target.result);h(c.version);p[g]=c.version;j.localStorage.setItem("pages",JSON.stringify(p))}catch(q){console.log("读取"+g+".json，数据格式错误！");try{l.remove();if(typeof p[g]!="undefined"){delete p[g]}j.localStorage.setItem("pages",JSON.stringify(p))}catch(q){}a();return}};m.readAsText(n)},function(m){console.log("读取"+g+".json，获取文件对象失败："+m.message);a()})};var f=function(l){plus.io.resolveLocalFileSystemURL("_www/data/"+g+".json",function(m){plus.io.resolveLocalFileSystemURL("_doc/",function(n){m.copyTo(n,g+".json",function(o){l(o)},function(o){console.log("copyTo:"+o.code+","+o.message);n.getFile(g+".json",{},function(p){l(p)},function(){l(false)})})},function(n){console.log("resolveLocalFileSystemURL:"+n.message);l(false)})},function(m){console.log("resolveLocalFileSystemURL:"+m.message);l(false)})};var a=function(){mui.alert("获取页面配置失败请重新安装App","温馨提示",function(){if(mui.os.ios){mui.alert("请双击Home键退出程序")}else{plus.runtime.quit()}})};var h=function(l){mui.sendRequest(mui.constMap.ROOT_PATH+"update/config/"+g,{version:l,ios:mui.os.ios?1:0,config:{silence:true}},function(o){if(!o.status.succeed){mui.toast(o.status.error_desc);return}if(o.data.json.length>0){var n=c;try{c=JSON.parse(o.data.json);plus.io.resolveLocalFileSystemURL("_doc/"+g+".json",function(p){p.createWriter(function(q){q.onwrite=function(r){plus.console.log("Write data success!")};q.seek(0);q.write(o.data.json);if(!mui.os.stream){plus.webview.currentWebview().reload()}},function(q){})},function(p){})}catch(m){c=n}}})};var k=function(){return g!=""};var b=function(p){var l=p.split("|");var o=c.data;l.push("extras");for(var n=0,m=l.length;n<m&&o;n++){o=o[l[n]]}return o};return{load:i,isReady:k,get:b}})(window);